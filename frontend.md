# 前端 UI 完整设计方案

------

## 1. 登录与注册页面

### 1. 元素模块设计

| 模块     | 元素               | 功能说明                     |
| -------- | ------------------ | ---------------------------- |
| 登录模块 | 账号输入框         | 输入登录账号                 |
| 登录模块 | 密码输入框         | 输入登录密码                 |
| 登录模块 | 登录按钮           | 提交账号和密码，进入系统     |
| 登录模块 | 忘记密码链接       | 跳转到密码找回流程           |
| 登录模块 | 注册入口按钮       | 跳转到注册页面               |
| 注册模块 | 姓名输入框         | 填写用户姓名                 |
| 注册模块 | 工号输入框         | 填写个人工号                 |
| 注册模块 | 登录账号输入框     | 设置登录账号                 |
| 注册模块 | 密码输入框         | 设置密码                     |
| 注册模块 | 确认密码输入框     | 确认密码                     |
| 注册模块 | 所属院系选择       | 选择所属院系，仅显示可选范围 |
| 注册模块 | 邮箱输入框         | 填写邮箱                     |
| 注册模块 | 手机输入框（可选） | 填写手机号                   |
| 注册模块 | 注册按钮           | 提交注册信息                 |

### 2. 页面具体设计

- - 登录/注册界面采用 **居中卡片式布局**，卡片宽度约为页面宽度的 **32%（最小 360px，最大 480px）**，高度随内容自适应。
  - 页面使用 **浅灰色背景（#F5F6FA）**，卡片使用 **白色背景（#FFFFFF）**，带有轻微阴影（如 shadow: 0 2px 12px rgba(0, 0, 0, 0.08)）。
  - 卡片边角使用 **8px 圆角**，整体风格简洁、现代。
- **标题区域**
  - 卡片顶部显示“大标题”（如“登录”“注册账号”），使用 **18–22px 中粗字体**（`font-weight: 600`），颜色为 **深灰 #333**，左对齐。
  - 标题与表单之间保持 **24px 间距**。
- **输入框设计**
  - 所有输入框统一采用 **100% 卡片宽度**，高度 **42–48px**，圆角 **6px**。
  - 边框颜色使用 **#D0D4DA**，获得焦点时变为 **主色 #3A7AFE**，并带轻微光晕。
  - 输入框内填充（padding）为：**左右 12px**。
  - 输入框之间保持 **16px 垂直间距**，整体视觉清爽。
- **下拉选择（所属院系）**
  - 展开方式与输入框一致，但选项区域使用白底 + 主色 hover（#F0F5FF）。
  - 每项高度为 **38–42px**，字体 14px。
- **按钮设计**
  - “登录”“注册”按钮宽度为 **100% 卡片宽度**，高度约 **44–48px**。
  - 采用圆角 **8px**，背景色为 **主色蓝 #3A7AFE**，鼠标悬浮时变为 **#2068FF**。
  - 字体为 **白色加粗（font-weight: 600）**，字号 **15–16px**。
- **辅助链接**
  - “忘记密码？”使用 **12–14px 字体**，颜色为 **#3A7AFE（主色）**，放置在表单右下角，按钮与其之间保持 **12px** 间距。
  - “没有账号？去注册 →” 放置在卡片底部居中区域，文字为 **#555**，链接为蓝色。
- **注册页面的额外字段（姓名/工号/院系/邮箱/手机号）**
  - 所有字段垂直排列，间距一致。
  - 表单长度较长，因此卡片整体高度适当增加，但最大高度不超过视口 85%，必要时自动出现滚动条（overflow-y: auto）。
- **字体与配色整体要求**
  - 全局字体使用 `sans-serif`，推荐 `“Inter”, “Microsoft YaHei”`。
  - 主色：**#3A7AFE（蓝）**
  - 辅助色：**#4A4A4A、#666、#999**
  - 背景色：**#F5F6FA**
  - 边框色：**#D0D4DA**
  - 错误提示使用 **红色 #FF4D4F** 放在输入框下方，以 12px 字体呈现。

### 3. 前后端衔接逻辑

- **涉及表**：Secretary、Teacher、Department
- **操作描述**：
  - 登录验证 → Secretary 表中查 account、password_hash
  - 注册 → Secretary 表新增一条记录，包括 name、account、password_hash、email、department_id
  - 下拉选择院系 → Department 表查询 id 与 name
  - 绑定教师信息（若秘书也是教师） → Teacher 表中查找匹配的教师 id

------

## 2. 左侧导航栏 + 顶部横幅

### 1. 元素模块设计

| 标签       | 功能说明                                     |
| ---------- | -------------------------------------------- |
| 首页概览   | 展示个人信息和任务/邮件总体情况              |
| 任务总览   | 创建、查看、催促、关闭和导出任务             |
| 表单模板   | 创建、查看和编辑表格模板                     |
| 已汇总表单 | 管理和下载汇总表                             |
| 系统设置   | 修改个人账户信息和密码                       |
| 顶部横幅   | 显示大标题“邮件汇总系统”，右侧显示“登出”按钮 |

### 2. 界面具体设计

- **页面分区**
  - 页面采用 **左右分栏 + 顶部横幅** 布局：
    - 左侧导航栏宽度约 **220px**，固定高度 100%，背景色 **#FFFFFF**，边界右侧有轻微阴影（shadow: 2px 0 6px rgba(0,0,0,0.06)）。
    - 右侧区域为主内容区，顶部预留 **横幅栏**，高度约 **60px**，背景色 **#F5F6FA**，内部左侧显示系统标题，右侧显示“登出”按钮，剩余空间用于各栏目内容展示。
    - ==左侧导航栏 + 顶部横幅设计成 **单独组件**，便于后续在各栏目页面复用。==
- **左侧导航栏**
  - 导航标签采用 **垂直列表**，标签高度 **48px**，文字字号 **14–15px**，颜色 **#333**，鼠标悬停或选中时背景色为 **#F0F5FF**，文字颜色为 **#3A7AFE**（主色）。
  - 左侧导航栏与右侧内容区之间保留 **1px 分隔线** 或轻微阴影。
  - 导航栏固定在视口左侧，滚动内容时保持固定。
- **顶部横幅**
  - 高度 **60px**，内边距左右 **24px**，左侧显示大标题 “邮件汇总系统”，字号 **18–20px**，字体加粗 **font-weight: 600**，颜色 **#333**，垂直居中。
  - 右侧“登出”按钮宽度约 **80px–100px**，高度 **36px**，圆角 **6px**，背景色 **#3A7AFE**，悬停时背景色 **#2068FF**，字体白色加粗 **font-weight: 600**，点击触发登出逻辑。
- **主内容区**
  - 顶部横幅下方为各栏目内容区域，每个栏目单独设计为元素，内容高度自适应，超出视口高度时出现 **纵向滚动条**。
  - 内容区左右内边距约 **24px**，上下间距根据内容自适应。
  - 背景色 **#F5F6FA**，整体风格保持与卡片式登录/注册界面一致的简洁、现代感。
- **字体与配色整体要求**
  - 全局字体使用 `sans-serif`，推荐 `"Inter", "Microsoft YaHei"`
  - 主色：**#3A7AFE（蓝）**
  - 辅助色：**#4A4A4A、#666、#999**
  - 背景色：**#F5F6FA**
  - 阴影与边框色：**#D0D4DA**

## 3. 首页概览页面

### 1. 元素模块设计

| 模块         | 表格 / 元素      | 功能说明                                       |
| ------------ | ---------------- | ---------------------------------------------- |
| 个人信息模块 | 用户照片         | 显示教秘头像                                   |
| 个人信息模块 | 用户名           | 显示登录名                                     |
| 个人信息模块 | 工号             | 显示教秘工号                                   |
| 个人信息模块 | 所属院系         | 展示院系名称                                   |
| 个人信息模块 | 邮箱             | 展示邮箱                                       |
| 个人信息模块 | 电话             | 展示联系电话                                   |
| 任务总览模块 | 总任务数         | 展示个人创建任务总数量                         |
| 任务总览模块 | 各状态任务数量   | 分别显示未发布、已发布、超时未关闭、已关闭数量 |
| 邮件总览模块 | 发出邮件总数     | 展示已发送邮件数量                             |
| 邮件总览模块 | 收到邮件总数     | 展示收到邮件数量                               |
| 邮件总览模块 | 已汇总邮件数     | 展示已生成汇总的邮件数量                       |
| 邮件总览模块 | 未汇总邮件数     | 展示尚未生成汇总的邮件数量                     |
| 邮件总览模块 | 已生成汇总表数量 | 展示合并生成的汇总表数量                       |

### 2. 界面细致设计

- **整体布局结构**
  - 页面右侧内容区采用 **三块纵向结构：个人信息卡片 + 任务总览卡片 + 邮件总览卡片**，三块均为横向卡片形式排列，每块内部再细分模块。
  - 总体展示区宽度为右侧内容区的 **92%**，左右居中，顶部到横幅栏保持 **24px 间距**。
- **卡片外观**
  - 三个模块均使用 **白色背景（#FFFFFF）**、**圆角 10px**、**阴影 0 2px 10px rgba(0,0,0,0.06)**。
  - 外边距统一为 **20px** 上下间距，内部 padding **20–24px**。
  - 宽度：并排展示时，每张卡片约为父容器宽度的 **31%–33%**（视屏幕自动缩放）；窄屏情况自动换行。
- **卡片标题**
  - 每块的左上角展示标题（如“个人信息”、“任务总览”、“邮件总览”）。
  - 字号 **18px**、加粗、颜色 **#333**，下方与内容保持 **16px 间距**。
- **个人信息模块设计**
  - 整体采用 **横向布局**：左侧头像 + 右侧信息。
  - **头像**
    - 使用圆形头像框，直径 **64–72px**。
    - 外圈加 **2px 边框 #E5E7EB**。
  - **文字信息区**
    - 按“用户名 / 工号 / 所属院系 / 邮箱 / 电话”纵向排列。
    - 每行高度约 **22–24px**，字体 **14–15px**，主色深灰 **#4A4A4A**。
    - 关键字段使用 **#1F2937**（略深）。
- **任务总览模块设计**
  - 内部采用 **四宫格布局**：总任务数在最左，其余状态任务（未发布/已发布/超时未关闭/已关闭）以两行两列方式呈现。
  - 每个统计块采用小卡片样式：白底、浅灰边框、圆角 8px、padding 12px。
  - 数字部分使用 **20–24px 加粗字体** + **主题色 #3A7AFE**。
  - 标签说明用 **12–13px 灰色 #6B7280**。
- **邮件总览模块设计**
  - 采用 **三列 × 两行** 的网格布局，共六项指标。
  - 每个统计单元块采用提升样式：轻微背景区分（#F9FAFB）、内间距 16px、圆角 8px。
  - 统计数字使用 **主题蓝 #3A7AFE**，字体大小 **18–22px**。
  - 标题为 **#4B5563** 的 13px 字体。
- **字体与配色整体**
  - 字体统一使用 `Inter, Microsoft YaHei, sans-serif`。
  - 主色：#3A7AFE
  - 辅助深灰：#374151
  - 浅灰：#E5E7EB
  - 背景色（页面整体）：#F5F6FA

------

### 3. 前后端衔接逻辑

#### 1. 个人信息模块

所有个人信息均来自 **Secretary**。

- 登录成功后，后端根据 session/token 中的 `secretary_id` 查询：
  - 从 **Secretary** 表查询该秘书的：
    - `name`（展示用户名）
    - `id`（展示工号）
    - `email`
    - `phone`
    - `department_id`
    - 若前端有头像字段，可放在 `extra` 中，自行定义。
- 再根据 `department_id` 到 **Department** 表查询：
  - `name`（展示院系名称）

#### 2. 任务总览模块

任务相关统计全部来自 **CollectTask（任务表）**

#### 3. 邮件总览模块

所需统计如下：

- 发出邮件总数：从 **SentEmail** 表统计 `from_sec_id = 当前 secretary_id` 的数量。

- 收到邮件总数：从 **ReceivedEmail** 表统计 `to_sec_id = 当前 secretary_id` 的数量。

- 已汇总邮件总数：从 **ReceivedEmail** 表中过滤：
  - `to_sec_id = 当前 secretary_id`
  - `is_aggregated = TRUE`
  - 得到数量。

- 未汇总邮件数：从 **ReceivedEmail** 表中过滤：
  - `to_sec_id = 当前 secretary_id`
  - `is_aggregated = FALSE`
  - 得到数量。

- 已生成汇总表数量：统计 Aggregation 表

------

## 4. 任务总览页面

### 1. 元素模块设计

#### 任务列表模块（一个表格）

| 表格列名        | 显示内容                              | 操作/功能说明                                                |
| --------------- | ------------------------------------- | ------------------------------------------------------------ |
| 任务名称        | 任务名称                              | ✔ 点击可打开一个“展示任务描述”的弹窗（不是“任务详情弹窗”）                                   |
| 发布时间        | 创建时间                              | 显示任务发布时间                                             |
| 截止时间        | 截止日期                              | 显示任务截止日期                                             |
| 表格模板        | 所选模板名称                          | 下拉选择，仅显示“表单模板”页面中存在的模板                   |
| 已回复/总教师数 | 已回复人数 / 总目标教师人数           | 点击查看详情（打开任务详情弹窗）                       |
| 状态            | 未发布 / 已发布 / 超时未关闭 / 已关闭 | 显示当前任务状态                                             |
| 操作            | 根据状态显示操作按钮                  | - 未发布：编辑 - 已发布未关闭：一键催促 / 提前关闭 - 已关闭：合并并导出 |

------

#### 任务详情弹窗（对应“任务名称”与“已回复/总教师数”列）

| 列名     | 显示内容        | 功能说明             |
| -------- | --------------- | -------------------- |
| 教师姓名 | 教师姓名        | 显示目标教师         |
| 工号     | 教师工号        | 显示教师工号         |
| 邮箱     | 教师邮箱        | 显示                 |
| 回复状态 | 已回复 / 未回复 | 未回复排在前，可排序 |

------

#### 新建任务弹窗（多步骤流程）

| 字段     | 功能说明                                   |
| -------- | ------------------------------------------ |
| 任务名称 | 填写任务名称（对应 CollectTask.name）      |
| 任务描述 | 写入 CollectTask.extra.description         |
| 截止时间 | 选择任务截止日期（必须大于当前时间）       |
| 发布时间 | 立即发布 / 自定义时间发布                  |
| 表格模板 | 下拉选择，仅显示“表单模板”页面中存在的模板 |
| 邮件标题 | 邮件标题字段                               |
| 邮件正文 | 邮件文本内容（可用变量）                   |
| 教师列表 | 选择目标教师（仅显示本院教师，可全选）     |

------

**编辑任务弹窗（仅对未发布任务）**

| 字段           | 功能说明                                                     |
| -------------- | ------------------------------------------------------------ |
| 与新建任务相同 | 可以修改名称、任务描述、截止时间、模板、邮件内容、教师列表、发布方式 |

------

### 2. 界面具体设计

#### 任务列表主界面

- 页面顶部右上角放置“新建任务”按钮（主色蓝色，圆角按钮，高度 38px）。
- 下方为任务表格，整体放入圆角（12px）卡片中，带轻微阴影。
- 表格行高 56px，列间距均匀，可滚动分页。
- “任务名称”列为蓝色可点击文本，鼠标悬停变深色。
- “状态”列颜色区分：
  - 未发布：灰色
  - 已发布：蓝色
  - 超时未关闭：红色
  - 已关闭：绿色
- 操作按钮为小尺寸按钮（高度约 32px），颜色随操作类型定义：
  - 编辑：灰色
  - 催促：橙色
  - 提前关闭：红色
  - 合并并导出：绿色

------

#### 任务详情弹窗

- 居中弹窗（宽约 800px），标题“任务回复详情”。
- 内容为表格（列表教师：姓名、工号、邮箱、回复状态）。
- 未回复默认排前，支持排序。
- 底部为“关闭”按钮。

------

#### 新建任务弹窗（三步骤）

- 弹窗宽 720px，顶部为步骤进度条（步骤① → ② → ③）。
- **步骤① 基础信息**
  - 任务名称（输入框）
  - 任务描述（多行文本）
  - 截止时间（日期时间选择器）
  - 发布时间（立即 / 自定义）
- **步骤② 模板与邮件**
  - 表格模板选择（下拉框）
  - 邮件标题（输入框）
  - 邮件正文（富文本或多行文本）
- **步骤③ 教师列表**
  - 表格展示所有教师
  - 左侧为 checkbox
  - 顶部提供“全选”开关
  - 支持搜索与分页
- 弹窗底部按钮：取消 / 上一步 / 下一步 或 完成

------

#### 编辑任务弹窗

- 与新建任务弹窗一致，但：
  - 不显示步骤条（可一次性编辑全部字段）
  - 仅允许编辑未发布任务
  - 保存按钮替代“完成”按钮

------

### 3. 前后端衔接逻辑

#### 页面加载逻辑（任务列表页面）

前端加载任务表格时，需要请求：

- CollectTask 表：
  - 查询字段：id, name, created_at, deadline, template_id, started_time, status, extra
  - extra.description（任务描述）仅在详情与编辑中使用

- 模板名称：根据 template_id 从 TemplateForm 表查 name

- 统计回复人数：
  - 已回复人数：从 ReceivedEmail 表按 task_id 和 from_tea_id 去重统计（教师已回复）
  - 总教师人数：从 CollectTaskTarget 表按 task_id 统计 teacher_id 数量

------

#### 点击“任务名称”或“已回复/总教师数” → 加载任务详情弹窗

需要进行 3 次查询并合并：

- CollectTaskTarget 表：读取 task_id 对应的 teacher_id 列表

- Teacher 表：根据 teacher_id 获取 name、id、email

- ReceivedEmail 表：查询 task_id 对应的 from_tea_id，标记教师是否已提交

最后合并生成教师列表 → 返回前端表格展示

------

#### 新建任务流程（后端写入逻辑）

1. 写入 CollectTask 表

   - name
   - template_id
   - extra.description
   - extra.mail_subject
   - extra.mail_content
   - deadline
   - started_time（立即发布=当前时间，自定义=用户选择时间）
   - status：
     - 立即发布 → "ACTIVE"
     - 自定义时间未来 → "DRAFT"

2. 写入 CollectTaskTarget 表

   - task_id ← 新建 CollectTask ID
   - teacher_id ← 选择的目标教师列表

3. 邮件发送逻辑（立即发布任务时）

   - 遍历目标教师 teacher_id
   - 生成 SentEmail 记录
   - 调用邮件发送服务

------

#### 编辑任务

- 仅 status="DRAFT" 的任务允许修改
- 更新 CollectTask：name / template_id / extra.description / extra.mail_subject / extra.mail_content / deadline / started_time
- 更新 CollectTaskTarget：覆盖原教师列表

------

#### 操作按钮后端逻辑

| 状态   | 按钮       | 后端逻辑                                            |
| ------ | ---------- | --------------------------------------------------- |
| DRAFT  | 编辑       | 返回任务全部信息（CollectTask + CollectTaskTarget） |
| ACTIVE | 一键催促   | 找出未回复教师 → 调用邮件系统发送提醒               |
| ACTIVE | 提前关闭   | CollectTask.status = "CLOSED"                       |
| CLOSED | 合并并导出 | 读取 ReceivedEmail → 按模板生成 XLSX 并返回下载地址 |

## 5. 表单模板页面

### 1. 元素模块设计

| 表格列名 | 显示内容     | 操作/功能说明                |
| -------- | ------------ | ---------------------------- |
| 模板名称 | 表单模板名称 | 点击查看字段详情弹窗         |
| 创建时间 | 模板创建时间 | 显示创建日期                 |
| 操作     | 编辑 / 删除  | 仅本人创建的模板可编辑或删除 |

**字段详情弹窗（查看模板字段列表）**

| 列名     | 显示内容                                       |
| -------- | ---------------------------------------------- |
| 字段名称 | 字段显示名称                                   |
| 字段类型 | 文本 / 数字 / 日期 / 时间 / 布尔 / 单选 / 多选 |
| 是否必填 | 是 / 否                                        |
| 顺序     | 字段显示顺序                                   |

**新建模板弹窗**

| 字段     | 功能说明                                             |
| -------- | ---------------------------------------------------- |
| 模板名称 | 填写模板名称                                         |
| 字段设置 | + 按钮添加字段，设置名称、类型、是否必填，可循环增加 |
| 保存按钮 | 保存模板及字段                                       |

### 2. 界面具体设计

1. 模板列表模块

- 页面顶部有“新建模板”按钮，点击弹出新建模板弹窗
- 表格显示所有模板：
  - 模板名称：可点击，弹出字段详情弹窗
  - 创建时间：显示模板创建时间
  - 操作列：
    - 编辑：仅本人创建的模板可点击，弹出编辑弹窗
    - 删除：仅本人创建的模板可点击，提示确认删除

2. 字段详情弹窗

- 弹窗标题为“模板字段详情”
- 表格列：
  - 字段名称
  - 字段类型（文本 / 数字 / 日期 / 时间 / 布尔 / 单选 / 多选）
  - 是否必填
  - 顺序
- 支持按顺序排序字段，查看完整字段信息

3. 新建模板弹窗 / 编辑模板弹窗

- 多步骤表单：
  1. 输入模板名称
  2. 字段设置：
     - 可点击“+”添加新字段
     - 每个字段可设置：名称、类型、是否必填
     - 支持拖拽调整字段顺序
     - 支持删除某个字段
  3. 保存按钮：提交后保存模板及字段

------

### 3. 前后端衔接逻辑

#### 页面加载逻辑（模板列表）

前端请求：

- TemplateForm 表：
  - 查询字段：id, name, created_by, created_at
  - 仅显示当前用户或可访问的模板

- TemplateFormField 表：
  - 根据模板 id 查询字段信息，用于字段详情弹窗：
    - id, form_id, display_name, data_type, required, ord

------

#### 点击“模板名称” → 加载字段详情弹窗

- 查询 TemplateFormField 表：
  - form_id = 选中模板 id
  - 返回 display_name、data_type、required、ord
- 按 ord 排序显示

------

#### 新建模板流程（后端写入逻辑）

1. 写入 TemplateForm 表：
   - name
   - created_by = 当前用户 id
   - extra = 可选扩展信息

2. 写入 TemplateFormField 表：
   - form_id = 新建 TemplateForm ID
   - display_name / data_type / required / ord
   - 可循环插入多个字段记录

------

#### 编辑模板流程

- 仅本人创建的模板可编辑
- 更新 TemplateForm.name 或 extra
- 更新 TemplateFormField：
  - 可新增字段
  - 可修改已有字段 display_name / data_type / required / ord
  - 可删除字段

------

#### 删除模板逻辑

- 仅本人创建的模板可删除
- 删除 TemplateForm 记录
- 删除对应 TemplateFormField 所有字段记录

------

## 6. 已汇总表单页面

### 1. 元素模块设计

| 表格列名   | 显示内容     | 操作/功能说明        |
| ---------- | ------------ | -------------------- |
| 汇总表名称 | 汇总表名称   | 展示                 |
| 对应任务   | 任务名称     | 展示对应任务         |
| 汇总时间   | 汇总生成时间 | 展示                 |
| 记录数量   | 汇总条数     | 展示                 |
| 下载链接   | 点击下载文件 | 直接下载生成的汇总表 |

### 2. 界面具体设计

汇总列表模块（表格视图）

- 页面顶部右侧放置“刷新”按钮和可选的“按任务/时间筛选”控件。
- 表格列：
  - 汇总表名称（展示 Aggregation.name）
  - 任务名称（展示关联的 CollectTask.name）
  - 汇总时间（展示 Aggregation.generated_at）
  - 记录数量（展示 Aggregation.record_count）
  - 下载链接（每行一个下载按钮，展示下载图标）
- 行样式：
  - 表头加粗、浅灰背景；行高 48px；hover 时行背景微亮以提示可交互；
  - 下载按钮为小尺寸蓝色圆角按钮（高度约 32px），鼠标悬停变深色。

表格交互

- 支持按“任务名称 / 汇总时间”排序，支持按时间范围过滤（日期选择器）。
- 支持分页展示，默认每页 20 条。
- 支持批量操作占位（未来扩展），但当前仅实现单条下载。

视觉与排版

- 页面主体在主内容区内水平居中，左右内边距 24px。
- 字体使用 `Inter, Microsoft YaHei, sans-serif`，主色 #3A7AFE，辅助色 #4A4A4A。
- 表格整体使用白色卡片（圆角 10px、轻微阴影），背景为 #F5F6FA。

## 7. 系统设置页面

| 字段     | 功能说明                   |
| -------- | -------------------------- |
| 姓名     | 修改用户名                 |
| 工号     | 展示不可修改               |
| 登录账号 | 展示不可修改               |
| 邮箱     | 修改邮箱                   |
| 电话     | 修改手机号                 |
| 密码修改 | 设置新密码，输入旧密码确认 |
